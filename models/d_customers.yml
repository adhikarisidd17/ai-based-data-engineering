SELECT 
    id,
    name,
    last_name,
    email,
    phone_number,
    dob,
    CASE 
        WHEN purchase_count > 5 THEN 'Gold'
        WHEN purchase_count BETWEEN 3 AND 5 THEN 'Silver'
        ELSE 'Bronze'
    END AS loyalty
FROM 
    source_table; 

version: 2

models:
  - name: d_customers
    latest_version: 1
    config:
      materialized: table

    description: "Table containing customer information for MinButik"
    columns:
      - name: id
        description: "Unique identifier for the customer"
      - name: name
        description: "Customer's first name"
      - name: last_name
        description: "Customer's last name"
      - name: email
        description: "Customer's email address"
      - name: phone_number
        description: "Customer's phone number"
      - name: dob
        description: "Date of birth of the customer"
      - name: loyalty
        description: "Loyalty tier of the customer based on purchase history"
        data_type: "string"